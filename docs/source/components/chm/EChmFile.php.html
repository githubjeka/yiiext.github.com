<html>
    <head>
        <script type="text/javascript" src="../../../js/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="../../../syntax_highlighter/scripts/shCore.js"></script>
        <script type="text/javascript" src="../../../syntax_highlighter/scripts/shBrushJScript.js"></script>
        <script type="text/javascript" src="../../../syntax_highlighter/scripts/shBrushPhp.js"></script>
        <script type="text/javascript" src="../../../syntax_highlighter/scripts/shBrushXml.js"></script>
        <link href="../../../syntax_highlighter/styles/shCore.css" rel="stylesheet" type="text/css" />
        <link href="../../../syntax_highlighter/styles/shCoreEclipse.css" rel="stylesheet" type="text/css" />
        <link href="../../../syntax_highlighter/styles/shThemeWordpress.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * ChmFile class file.
 *
 * @author Veaceslav Medvedev &lt;slavcopost@gmail.com&gt;
 * @link http://code.google.com/p/yiiext/
 * @license http://www.opensource.org/licenses/mit-license.php
 */

/**
 * ChmFile.
 *
 * @author Veaceslav Medvedev &lt;slavcopost@gmail.com&gt;
 * @version 0.1
 * @package yiiext.components.chm
 */
class EChmFile extends CComponent
{
	public function __construct($config=NULL)
	{
		$config=new CConfiguration($config);
		$config-&gt;applyTo($this);
	}
	public function getParams()
	{
		$compNames=array(
			// EChmHhpFile
			'autoIndex'=&gt;'Auto Index',
			'autoToc'=&gt;'Auto TOC',
			'binaryIndex'=&gt;'Binary Index',
			'binaryToc'=&gt;'Binary TOC',
			'citation'=&gt;'CITATION',
			'compress'=&gt;'COMPRESS',
			'copyright'=&gt;'COPYRIGHT',
			'compiledFile'=&gt;'Compiled file',
			'contentsFile'=&gt;'Contents file',
			'createChiFile'=&gt;'Create CHI file',
			'defaultFont'=&gt;'Default Font',
			'defaultWindow'=&gt;'Default Window',
			'defaultTopic'=&gt;'Default topic',
			'displayCompileNotes'=&gt;'Display compile notes',
			'displayCompileProgress'=&gt;'Display compile progress',
			'enhancedDecompilation'=&gt;'Enhanced decompilation',
			'errorLogFile'=&gt;'Error log file',
			'fullTextSearchStopListFile'=&gt;'Full text search stop list file',
			'fullTextSearch'=&gt;'Full-text search',
			'ignore'=&gt;'IGNORE',
			'indexFile'=&gt;'Index file',
			'prefix'=&gt;'PREFIX',
			'sampleStagingPath'=&gt;'Sample Staging Path',
			'sampleListFile'=&gt;'Sample list file',
			'tmpDir'=&gt;'TMPDIR',
			'customTab'=&gt;'Custom tab',
			// EChmHhcFile
			'Image Width'=&gt;'imageWidth',
			'styles'=&gt;'Window Styles',
			'extStyles'=&gt;'ExWindow Styles',
			'autoGenerated'=&gt;'Auto Generated',
			// EChmHhkItem
			'url'=&gt;'URL',
			'seeAlso'=&gt;'See Also',
		);
		$vars=array();
		foreach(get_object_vars($this) as $name=&gt;$value)
		{
			if(substr($name,0,1)=='_' || !$value)
				continue;
			if(key_exists($name,$compNames))
				$name=$compNames[$name];

			$vars[ucfirst($name)]=$value;
		}
		return $vars;
	}
	public static function renderHtmlList($items)
	{
		$html='';
		if(count($items)&gt;0)
		{
			$html.=&quot;&lt;UL&gt;\n&quot;;
			foreach($items as $item)
			{
				$html.=&quot;	&lt;LI&gt;&quot;.self::renderHtmlObject($item-&gt;getParams());
				if(count($item-&gt;children)&gt;0)
					$html.=self::renderHtmlList($item-&gt;children);
			}
			$html.=&quot;&lt;/UL&gt;\n&quot;;
		}

		return $html;
	}
	public static function renderHtmlObject($params,$type='text/sitemap')
	{
		$html='';
		if(count($params)&gt;0)
		{
			$html.='&lt;OBJECT type=&quot;'.$type.'&quot;&gt;';
			foreach($params as $param=&gt;$value)
				$html.='&lt;param name=&quot;'.$param.'&quot; value=&quot;'.$value.'&quot;&gt;';
			$html.=&quot;&lt;/OBJECT&gt;\n&quot;;
		}

		return $html;
	}
	public function render()
	{
		return '&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;'.&quot;\n&quot;.
				'&lt;HTML&gt;&lt;HEAD&gt;'.&quot;\n&quot;.
				'&lt;META name=&quot;GENERATOR&quot; content=&quot;yiiext.components.chm&quot;&gt;'.&quot;\n&quot;.
				'&lt;/HEAD&gt;&lt;BODY&gt;'.&quot;\n&quot;.
				self::renderHtmlObject($this-&gt;getParams(),'text/site properties').
				self::renderHtmlList($this-&gt;getItems()).
				'&lt;/BODY&gt;&lt;/HTML&gt;'.&quot;\n&quot;;
	}
	public function save($path,$sourceCharset='UTF-8')
	{
		if($sourceCharset!==FALSE)
			$contents=iconv($sourceCharset,&quot;CP1251&quot;,$this-&gt;render());

		!file_exists($path) OR unlink($path);
		return file_put_contents($path,$contents,LOCK_EX);
	}
}
</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all()
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>